<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_cmt_acc_voucher" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="6616782b-7889-445b-8a6d-172bfa350243">
	<property name="ireport.zoom" value="1.771561000000001"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="as_scoop" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="adtm_start" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="adtm_end" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_entryid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_reportid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_reportdetail" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\SCOSPA_ALL\\iReport\\report_header\\"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
f.payslip_no,
f.receipt_no,
f.slip_date,
f.payment_desc,
f.item_amt,
f.itemnet_amt,
f.pay_recv_status,
d.account_no,
b.account_name,
m.balance_begin,
m.balance,
m.item_amt,
m.sign_operate,
min(m.balance_begin) keep (
        dense_rank first order by m.seq_no
    ) over (
        partition by d.account_no, m.operate_date
    ) as begin_amt
from
finslip f
left join finslipdet d
	on f.slip_no = d.slip_no
left join finbankaccount b
	on d.account_no = b.account_no
left join finbankstatement m
	on trim(f.slip_no) = trim(m.refer_slipno)
where f.coop_id = $P{as_scoop}
and f.slip_date between $P{adtm_start} and $P{adtm_end}
and f.payment_status = 1
and d.cash_type = 'CBT']]>
	</queryString>
	<field name="PAYSLIP_NO" class="java.lang.String"/>
	<field name="RECEIPT_NO" class="java.lang.String"/>
	<field name="SLIP_DATE" class="java.sql.Timestamp"/>
	<field name="PAYMENT_DESC" class="java.lang.String"/>
	<field name="ITEM_AMT" class="java.math.BigDecimal"/>
	<field name="ITEMNET_AMT" class="java.math.BigDecimal"/>
	<field name="PAY_RECV_STATUS" class="java.math.BigDecimal"/>
	<field name="ACCOUNT_NO" class="java.lang.String"/>
	<field name="ACCOUNT_NAME" class="java.lang.String"/>
	<field name="BALANCE_BEGIN" class="java.math.BigDecimal"/>
	<field name="BALANCE" class="java.math.BigDecimal"/>
	<field name="SIGN_OPERATE" class="java.math.BigDecimal"/>
	<field name="BEGIN_AMT" class="java.math.BigDecimal"/>
	<variable name="sum_g_debit" class="java.math.BigDecimal" resetType="Group" resetGroup="account_no" calculation="Sum">
		<variableExpression><![CDATA[$F{PAY_RECV_STATUS}==1?$F{ITEMNET_AMT}:0]]></variableExpression>
	</variable>
	<variable name="sum_g_credit" class="java.math.BigDecimal" resetType="Group" resetGroup="account_no" calculation="Sum">
		<variableExpression><![CDATA[$F{PAY_RECV_STATUS}==0?$F{ITEMNET_AMT}:0]]></variableExpression>
	</variable>
	<variable name="sum_all_debit" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PAY_RECV_STATUS}==1?$F{ITEMNET_AMT}:0]]></variableExpression>
	</variable>
	<variable name="sum_all_credit" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PAY_RECV_STATUS}==0?$F{ITEMNET_AMT}:0]]></variableExpression>
	</variable>
	<group name="account_no">
		<groupExpression><![CDATA[$F{ACCOUNT_NO}]]></groupExpression>
		<groupHeader>
			<band height="40">
				<textField>
					<reportElement uuid="d680809c-f669-4447-8c98-8cff0ba71312" x="0" y="0" width="555" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เลขที่บัญชี "+$F{ACCOUNT_NO}+" ชื่อบัญชี "+$F{ACCOUNT_NAME}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="efead1a2-7585-447d-90e7-e97b3f747a91" x="93" y="20" width="52" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[new java.text.SimpleDateFormat("dd/MM/yyyy").format($P{adtm_start})]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="0aceb4b3-c82c-489d-9c3a-29bdc582d1d7" x="145" y="20" width="110" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[ยอดยกมา]]></text>
				</staticText>
				<textField pattern="#,##0.00">
					<reportElement uuid="3b0a4f26-7cfb-40c3-bebd-7aafd93dd66c" x="455" y="20" width="100" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{BEGIN_AMT}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="20">
				<textField>
					<reportElement uuid="d21474f9-6db5-42e0-b244-dceee81fa057" x="0" y="0" width="255" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["รวมตามเลขที่บัญชี "+$F{ACCOUNT_NO}+" ชื่อบัญชี "+$F{ACCOUNT_NAME}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement uuid="69a42ce6-eebb-4576-bf29-8d8a27b9ecc7" x="255" y="0" width="100" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_g_debit}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement uuid="f504c7e8-a5f0-4e13-85bd-9a175ca49e53" x="355" y="0" width="100" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{sum_g_credit}]]></textFieldExpression>
				</textField>
				<textField pattern="#,##0.00">
					<reportElement uuid="37bcb055-723f-4fc5-9ba8-124d6d02bccf" x="455" y="0" width="100" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{BALANCE}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="20" splitType="Stretch">
			<subreport>
				<reportElement uuid="8a3f00db-24b2-4fb0-bbac-adcdab72cda9" x="0" y="0" width="555" height="20"/>
				<subreportParameter name="as_coopid">
					<subreportParameterExpression><![CDATA[$P{as_scoop}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportid">
					<subreportParameterExpression><![CDATA[$P{as_reportid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_entryid">
					<subreportParameterExpression><![CDATA[$P{as_entryid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportdetail">
					<subreportParameterExpression><![CDATA["ตั้งแต่วันที่ "+new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($P{adtm_start})
+" ถึง "+new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($P{adtm_end})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "ir_header_portrait.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<staticText>
				<reportElement uuid="a01ba075-cba0-423c-be78-0c4f7aa04861" x="0" y="0" width="28" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ที่]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="06349925-4347-4e0b-a0fa-ea3608a3bd46" x="28" y="0" width="65" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[เลขที่เอกสาร]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7720178b-f6ed-48ba-9153-5457a93ed5c4" x="93" y="0" width="52" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[วันที่]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="d76113d6-6961-4744-9fd8-a215aa3dbe74" x="145" y="0" width="110" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[รายการ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="b3c13d11-d797-45b0-8392-4390edd96981" x="255" y="0" width="100" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[เดบิต]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="672e2ddc-7918-4d2a-ab4d-418864d4d1e9" x="355" y="0" width="100" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[เครดิต]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="d203150d-2606-45ec-902d-548990baa251" x="455" y="0" width="100" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[คงเหลือ]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="0aeedf4e-6313-4ff6-9e7c-8b0fbe875d79" x="28" y="0" width="65" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PAYSLIP_NO}==null?$F{RECEIPT_NO}:$F{PAYSLIP_NO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="8d316504-293e-4627-9ebf-452e7f711a1c" x="93" y="0" width="52" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.text.SimpleDateFormat("dd/MM/yyyy").format($F{SLIP_DATE})]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="22592097-bb41-454d-b5b0-1127cd019179" x="145" y="0" width="110" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PAYMENT_DESC}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="0a0b395f-2d64-42e1-a640-3a0a364bd043" x="255" y="0" width="100" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PAY_RECV_STATUS}==1?$F{ITEM_AMT}:0]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="f9b80e63-1816-4e7c-a747-50c5a6775496" x="355" y="0" width="100" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PAY_RECV_STATUS}==0?$F{ITEM_AMT}:0]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="82b8349f-3be0-4d32-8618-35baf1a48ac7" x="455" y="0" width="100" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{BALANCE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="2dca44d5-d7d0-47a8-a55c-28a16aa363f2" x="0" y="0" width="28" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{account_no_COUNT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
